---

---
---

### Security Assessments

- Vulnerability Assessments
	- Cost-effective method of identifying low hanging vulnerabilities
	- Skillset needed to conduct assessments is low
	- May not identify vulnerabilities requiring manual inspection
	- Potential false positives
	- Generic recommendations that may not be relevant
- Penetration Test
	- Provides an in-depth analysis of vulnerabilities and overall organizational security
	- Provides logical and realistic recommendations tailored to the target organization
	- Cost significantly more time and money
	- Requires a more in-depth security knowledge
- Security Audits
- Bug Bounties
- Red Team Assessment
- Purple Team Assessment (Red Team + Blue Team)

---

### Vulnerability Assessment

- Methodology
	1. Conduct Risk Identification And Analysis
	2. Develop Vulnerability Scanning Policies
	3. Identify the types of Scans
	4. Configure The Scan
	5. Perform The Scan
	6. Evaluate And Consider Possible Risks
	7. Interpret The Scan Results
	8. Create A Remediation & Migration Plan
- Key Terms:
	- Vulnerability: Weakness or bug in an organizations environment Vulnerabilities can be registered through MITRE's [Common Vulnerability Exposure database](https://cve.mitre.org/) and receive a [Common Vulnerability Scoring System (CVSS)](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator) score to determine severity.
	- Threat: A new incident with potential to harm a system.
	- Risk: The potential for damage when a threat exploits a vulnerability
	- Threat + Vulnerability = Risk
	- Exploit: An Exploit is any code or resources that can be used to take advantage of an asset's weakness. Many exploits are available through open-source platforms such as [Exploit-db](https://exploit-db.com/) or [the Rapid7 Vulnerability and Exploit Database](https://www.rapid7.com/db/).

- Likelihood Impact Matrix

|                |            |                 |   **Impact**    |                  |
| :------------: | :--------: | :-------------: | :-------------: | ---------------- |
|                |            |     **Low**     |   **Medium**    | **High**         |
|                |  **High**  | Medium Risk (3) |  High Risk (4)  | Highest Risk (5) |
| **Likelihood** | **Medium** |  Low Risk (2)   | Medium Risk (3) | High Risk (4)    |
|                |  **Low**   | Lowest Risk (1) |  Low Risk (2)   | Medium Risk (3)  |

- Asset Management
	- Asset Inventory
	- Application and System Inventory

--- 

### Assessments Standards

- Compliance Standards
	- The big compliance players in information security are PCI, HIPAA, FISMA and ISO 27001
- PCI-DSS: requirements include internal and external scanning of assets. For example, any credit card data that is being processed or transmitted must be done in a Cardholder Data Environment (CDE). This environment must be adequately segmented from normal assets. 
- Health Insurance Portability and Accountability Act (HIPPA): Is used to protect patients data. HIPPA does not necessarily require vulnerability scans or assessments; however, a risk assessment and vulnerability identification are required to maintain HIPAA accreditation.
- Federal Information Security Management Act (FISMA): is a set of standards and guidelines used to safeguard government operations and information. The act requires an organization to provide documentation and proof of a vulnerability management program to maintain information technology systems proper availability, confidentiality, and integrity.
- ISO 27001: is a standard used worldwide to manage information security. ISO 27001 requires organizations to perform quarterly external and internal scans

### Penetration Testing Standards

- Penetration tests should not be performed without any rules or guidelines.
- Penetration Testing Execution Standards (PTES): can be applied to all types of penetration tests. It outlines the phases of a penetration test and how they should be conducted. These are the sections in the PTES:
	- Pre-engagement Interactions
	- Intelligence Gathering 
	- Threat Modeling
	- Vulnerability Analysis
	- Exploitation
	- Post Exploitation
	- Reporting
- Open Source Security Testing Methodology Manual (OSSTMM): another set of guidelines pentesters can use to ensure they're doing their jobs properly. It can be used alongside other pentest standards. It is divided into five different channels:
	- Human Security
	- Physical Security
	- Wireless Communications (including but not limited to technologies like WiFi and Bluetooth)
	- Telecommunications
	- Data Networks
- National Institute of Standards and Technology (NIST): is well know for its [NIST Cybersecurity Framework](https://www.nist.gov/cyberframework), a system for designing incident response policies and procedures. NIST also has a Penetration Testing Framework. The phases of the NIST framework include:
	- Planning
	- Discovery
	- Attack
	- Reporting
- Open Web Application Security Project (OWASP): They're typically the go to organization for defining testing standards and classifying risks to web applications. It also maintains a few different standards and guides for assessing various technologies:
	-  [Web Security Testing Guide (WSTG)](https://owasp.org/www-project-web-security-testing-guide/)
	- [Mobile Security Testing Guide (MSTG)](https://owasp.org/www-project-mobile-security-testing-guide/)
	- [Firmware Security Testing Methodology](https://github.com/scriptingxss/owasp-fstm)

---

### Common Vulnerability Scoring System (CVSS)

- Standard used to score or calculate severity ratings of vulnerabilities.
- It is often used together with the so called [Microsoft DREAD](https://en.wikipedia.org/wiki/DREAD_(risk_assessment_model)) (Risk assessment system)
	- It is user to perform a risk analysis by using a scale of 10 points to assess the severity of a security threats and vulnerabilities. With this we calculate the risk of a threat or vulnearability based on five main factors:
		- Damage Potential
		- Reproducibility
		- Exploitability
		- Affected Users
		- Discoverability
### Severity Scoring

- The CVSS system helps categorize the severity associated with an issue and allows organizations to prioritize issues based on the rating.
	- It consists of the exploitability and impact of an issue.
	- The exploitability measurements consists of access vector, access complexity, and authentication. 
	- The impact metrics consist of the CIA triad, including confidentiality, integrity and availability.
	- [[CVSS Metrics.canvas|CVSS Metrics]]


___

### Common Vulnerabilities and Exposure (CVE)

- Open vulnerability assessment language (OVAL): is a publicly available information security international standard used to evaluate and detail the system's current state and issues.
- [[OVAL.canvas|OVAL]]
- The goal of the OVAL language is to have a three-step structure during the assessment process that consists of:
	- Identifying a system's configuration for testing
	- Evaluating the current system's state
	- Disclosing the information in a report
- The information can be described in various types of states, including: vulnerable, Non-Compliant, Installed Asset, and Patched.
- OVAL Definitions are recorded in an XML format to discover any software vulnerabilities, misconfigurations, programs, and additional system information taking out the need to exploit a system.
	- OVAL Vulnerability Definitions: Identifies system vulnerabilities 
	- OVAL Compliance Definitions: Identifies if current system configurations meet system policy requirements
	- OVAL Inventory Definitions: Evaluates a system to see if a specific software is present
	- OVAL Patch Definitions: Identifies if a system has the appropriate patch
	- OVAL ID Format: consists of a unique format that consists of "oval:Organization Domain Name:ID Type:ID Value". 
		- The ID Type can fall into various categories including: definition (def), object (obj), stat (ste), and variable (var). An example of a unique identifier would be oval:org.mitre.oval:obj:1116.
		- Scanners such as Nessus have the ability to us OVAL to configure security compliance scanning templates.

- [Common Vulnerabilities and Exposures (CVE)](https://cve.mitre.org/) is a publicly available catalog of security issues sponsored by the United States Department of Homeland Security (DHS).
- Each security issue has a unique CVE ID number assigned by the CVE Numbering Authority (CNA).

![CVE ID.drawio 1.png](https://github.com/kevinseq1/certified-penetration-testing-specialist/blob/main/6.%20Vulnerability%20Assessment/CVE%20ID.drawio%201.png?raw=true)

- Stages of obtaining a CVE:
	- Stage 1: Identify if a CVE is required and relevant
	- Stage 2: Reaching out to affected product vendor
	- Stage 3: Identify if the request should be for vendor CNA or third party CNA
	- Stage 4: Requesting CVE ID through CVE web form
	- Stage 5: Confirmation of CVE form
	- Stage 6: Receive of CVE ID
	- Stage 7: Public disclosure of CVE ID 
	- Stage 8: Announcing the CVE
	- Stage 9: Providing information to the CVE team
- Responsible disclosure: Disclosure of the vulnerability to the vendor before announcing to the public.
- Examples:
	- [CVE-2020-5902](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5902) is an unauthenticated, remote code execution vulnerability in the BIG-IP Traffic Management User Interface (TMUI).
	- [CVE-2021-34527](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34527), also known as PrintNightmare, is a remote code execution vulnerability within the Windows Print Spooler service.

___

